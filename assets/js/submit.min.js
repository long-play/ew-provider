
(function(){const ewill=new window.EWillCreate();const query=window.location.search.slice(1);const inputQuery=(query&&query.length>0)?`&${query}`:'';var HIDDEN='hidden';var SUCCESS='form__text--success';var ERROR='form__text--error';var formEmail=document.querySelector('.main__form--email');var emailInput=document.querySelector('.input-field__input[type=email]');var submitEmail=document.querySelector('.form__submit');var formCode=document.querySelector('.main__form--code');var formCodeContent=document.querySelector('.form__data-block--confirm');var hint=document.querySelector('.form__text--success');var hintEmail=hint.querySelector('.form__email');var hintError=document.querySelector('.form__text--error');var info=document.querySelector('.main__text--info');var infoError=document.querySelector('.main__text--error');var confirmCode=formCode.querySelector('.form__confirm');var codeInput=formCode.querySelector('.input-field__input[type=number]');const platformLink=document.querySelector('.main__link');var onEmailSubmit=function(e){gtag('event','Submit Email',{'event_category':'Submit Service Contacts','event_label':emailInput.value.replace(/^.*@/,'')});emailInput.setAttribute('disabled','true');submitEmail.setAttribute('disabled','true');hint.classList.add(HIDDEN);hintError.classList.add(HIDDEN);ewill.submitEmail(emailInput.value).then((response)=>{hint.classList.remove(HIDDEN);hintEmail.innerText=emailInput.value;formCodeContent.classList.remove(HIDDEN);}).catch((err)=>{hintError.classList.remove(HIDDEN);emailInput.removeAttribute('disabled');submitEmail.removeAttribute('disabled');});e.preventDefault();return false;};formEmail.addEventListener('submit',onEmailSubmit);var onCodeSubmit=function(e){gtag('event','Submit Code',{'event_category':'Submit Service Contacts'});codeInput.setAttribute('disabled','true');confirmCode.setAttribute('disabled','true');infoError.classList.add(HIDDEN);ewill.confirmEmail(emailInput.value,codeInput.value).then((response)=>{const redirect=`${WPConfig.platformUrl}/create-will.html`;const params=`?address=${response.address}&willId=${response.willId}&token=${response.token}&signaturev=${response.signature.v}&signaturer=${response.signature.r}&signatures=${response.signature.s}${inputQuery}`;platformLink.setAttribute('href',redirect+params);info.classList.remove(HIDDEN);gtag('event','Confirmation',{'event_category':'Submit Service Contacts','event_label':'success'});setTimeout(()=>{window.location=redirect+params},3000);}).catch((err)=>{gtag('event','Confirmation',{'event_category':'Submit Service Contacts','event_label':'error'});codeInput.removeAttribute('disabled');confirmCode.removeAttribute('disabled');infoError.classList.remove(HIDDEN);});e.preventDefault();return false;};formCode.addEventListener('submit',onCodeSubmit);})();